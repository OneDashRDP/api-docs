# OneDash.RDP API

Для работы с API используется GET/POST запросы:

    https://rdp-onedash.ru/web-api/{method}

Все параметры передаются в формате JSON (Content-Type: application/json).

Ответом на любой запрос будет JSON строка, содержащая параметр "type".

Пример успешного выполнения запроса:

    {"type": true}
    
Пример неудачного запроса:

    {"type": false}

# Авторизация

В теле каждого запроса, должен присутствовать апи ключ клиента в заголовке "Api-Key":

    Api-Key: 438b8af15a130133803f0ed0a2ae7d97d58b4605


# Тест запрос
	 
**GET**

**https://rdp-onedash.ru/web-api/test-request**

Пример успешного ответа:

    {"type": true}

# Список доступных ОС
	 
**GET**

**https://rdp-onedash.ru/web-api/systems-list**

Пример успешного ответа:

    {"type": true, "data": ["windows_10_ru", "windows_10_en", "windows_11_ru", "windows_11_en"]}
 
# Баланс аккаунта
	 
**GET**

**https://rdp-onedash.ru/web-api/balance**

Пример успешного ответа:

    {"type": true, "data": {"balance": 100, "currency": "RUB"}}

# Список тарифов
	 
**GET**

**https://rdp-onedash.ru/web-api/tariffs**

Пример успешного ответа:

    {"type":true,"data":[{"id":5,"name":"First","msk_prices":[{"price":49,"discount":0,"period":7},{"price":59,"discount":15,"period":10}],"ams_prices":[{"price":129,"discount":0,"period":7},{"price":159,"discount":15,"period":10}],"currency":"RUB","config_info":{"cpu":1,"ram":1,"hard":100}}]}

`"msk_prices"` - цены в локации Москва

`"ams_prices"` - цены в локации Амстердам

Цены указывается за каждый период аренды отдельно.

# Список всех заказов
	 
**GET**

**https://rdp-onedash.ru/web-api/all-orders**

Пример успешного ответа:

    {"type":true,"data":[{"order_id":19769,"tariff":{"id":5,"name":"First"},"location":"msk","vps_list":[{"id":12970,"os":"ubuntu_20","vps_ip":"123.123.123.13","vps_status":"runned"}],"finish_time":{"epoch":1886424023,"days_remaining":1665,"date":"11.10.2029 17:40"}}]}

Дата окончания аренды указана в Московском часовом поясе.

Возможные значения параметра `"vps_status"`:

`"runned"` - сервер запущен и готов к работе

`"not_runned"` - сервер в процессе запуска

`"cloning"` - сервер в процессе клонирования

# Создать впс
	 
Метод создает впс, списывая необходимую сумму с баланса аккаунта.

**POST**

**https://rdp-onedash.ru/web-api/create-vps**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `period`    | срок аренды: от 7 до 360 дней    |
| `tariff_id`    | айди тарифа: [список тарифов](#список-тарифов)    |
| `location`    | локация сервера: `"msk"` `"ams"`   |
| `system`    | операция система: [список ОС](#Список-доступных-ОС)    |
| `count`    | количество впс: от 1 до 10 шт.    |
| `additional_options["static_ip"]`    | доп. опция Выделенный IP: true/false (по умолчанию false)    |
| `additional_options["nvme"]`    | доп. опция диск NVME: true/false (по умолчанию false)    |
| `additional_options["backup"]`    | доп. опция рез. копирования: true/false (по умолчанию false)    |
| `processor`    | тип процессора: intel/amd (по умолчанию intel)    |

Возможные ошибки:

| Ошибка | Описание |
|-------------|-------------|
| `wrong_auth`    | авторизация неуспешна    |
| `wrong_parameters`    | один из параметров указан неверно   |
| `no_resources`    | недостаточно ресурсов под тариф и доп. опции   |
| `no_balance`    | недостаточно баланса|

Пример успешного ответа:

    {"type":true,"order_id": 10000}

# Информация о заказе
	 
**POST**

**https://rdp-onedash.ru/web-api/order-info**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `order_id`    | айди заказа    |

Пример успешного ответа:

    {"type":true,"data":{"order_id":10000,"tariff":{"id":5,"name":"First"},"location":"msk","vps_list":[{"id":10000,"os":"ubuntu_20","vps_ip":"123.123.123.13","vps_status":"runned"}],"finish_time":{"epoch":1886424023,"days_remaining":1662,"date":"11.10.2029 17:40"}}}

Дата окончания аренды указана в Московском часовом поясе.

Возможные значения параметра `"vps_status"`:

`"runned"` - сервер запущен и готов к работе

`"not_runned"` - сервер в процессе запуска

`"cloning"` - сервер в процессе клонирования

# Смена тарифа
	 
**POST**

**https://rdp-onedash.ru/web-api/change-tariff**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `order_id`    | айди заказа    |
| `new_tariff_id`    | айди нового тарифа: [список тарифов](#Список-тарифов)     |

Пример успешного ответа:

    {"type":true}

# Переустановка ОС
	 
**POST**

**https://rdp-onedash.ru/web-api/reinstall-system**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `vps_id`    | айди впс: [список всех заказов](#список-всех-заказов)    |
| `system`    | новая ОС: [Список доступных ОС](#Список-доступных-ОС)     |

Пример успешного ответа:

    {"type":true}

# Перезагрузка ВПС
	 
**POST**

**https://rdp-onedash.ru/web-api/restart-vps**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `vps_id`    | айди впс: [список всех заказов](#список-всех-заказов)    |

Пример успешного ответа:

    {"type":true}

# Клонирование ВПС

**POST**

**https://rdp-onedash.ru/web-api/cloning-vps**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `source_vps_id`    | айди впс-источника: [список всех заказов](#список-всех-заказов)    |
| `target_vpses`    | массив с целевыми серверами (их айди, до 5 штук): [список всех заказов](#список-всех-заказов)    |

Пример успешного ответа:

    {"type":true}

# Продление заказа

Метод продлевает заказ, списывая необходимую сумму с баланса аккаунта.
	 
**POST**

**https://rdp-onedash.ru/web-api/renew-order**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `order_id`    | айди заказа: [список всех заказов](#список-всех-заказов)    |
| `period`    | период продления (от 7 до 360 дней)    |


Пример успешного ответа:

    {"type":true}

# Пополнение баланса

Метод генерирует ссылку на оплату, для пополнения баланса аккаунта.
	 
**POST**

**https://rdp-onedash.ru/web-api/top-up-balance**

Возможные параметры:

| Параметр | Описание |
|-------------|-------------|
| `amount`    | сумма пополнения   |


Пример успешного ответа:

    {"type":true, "url": "https://pay.rdp-onedash.ru/pay/1234567890"}

